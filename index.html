<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dice Game</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="icon" href="icon.png">
</head>
<body>



<div class="container">
<img src="casino.png" class="dice_image">
  <div class="left-block">
    <h1 class="player">Player 1</h1>
    <h1 class="global_score1">0</h1>
  	<div class="round-score player-one">0</div>

  </div>
 <div>
  <h1 class="player-win_one notification notification-message">Le joueur 1 a gagné</h1>
</div>
<div>
  <h1 class="player-win_two notification notification-message">Le joueur 2 a gagné</h1>
</div>  

  <div class="button-container">
    <div class="first-button"><button><img src="dice.svg" class="dice_svg" /><h1 class="roll_dice dice-button">
ROLL DICE</h1></button></div>
	  <div class="second-button"><button><img src="download.svg" class="hold_svg"><h1 class="hold">HOLD</h1></button></div>
    <div class="third-button"><button ><img src="update.svg" class="update_svg"><h1 class="reset">Reset</h1></button></div>
  </div>
  <div class="right-block">
    <h1 class="player">Player 2</h1>
    <h1 class="global_score2">0</h1>
    <div class="round-score player-two">0</div> 
  </div>
</div>

<div class="notification alert"></div>

<script>
const playerOneScore = document.querySelector('.player-one');
const playerTwoScore = document.querySelector('.player-two');
const globalScore1 = document.querySelector('.global_score1');
const globalScore2 = document.querySelector('.global_score2');
const notificationElement = document.querySelector('.alert');
let rollDiceButton = document.querySelector('.roll_dice');
const audio_dice = new Audio('dice.mp3');
const audio_notification = new Audio('notif.mp3');
const player_win_one = document.querySelector('.player-win_one');
const player_win_two = document.querySelector('.player-win_two');
const holdButton = document.querySelector('.hold');

let count = 0;
let currentPlayer = 1;
let lastRollTime = 0;
const cooldownTime = 1000;



rollDiceButton.addEventListener('click', click_dice);
function click_dice() {
  gamover();
  const now = Date.now();
  if (now - lastRollTime < cooldownTime) {
    console.log("Le dé ne peut pas être tiré deux fois d'affilé");
    return;
  }

  lastRollTime = now;
  count = Math.floor(Math.random() * 6) + 1;
  console.log(count);
  
  if (currentPlayer === 1) {
    playerOneScore.textContent = +playerOneScore.textContent + count;
  }
  else {
    playerTwoScore.textContent = +playerTwoScore.textContent + count;
  }

  if (count === 1) {
    showNotification(`Le joueur ${currentPlayer} a obtenu 1. C'est le tour du joueur suivant`);
    if (currentPlayer === 1) {
      playerOneScore.textContent = 0;
    } else {
      playerTwoScore.textContent = 0;
    }
    currentPlayer = currentPlayer === 1 ? 2 : 1;
    audio_notification.play();
  }
  audio_dice.play();
};

function gamover() {
  if (parseInt(globalScore1.textContent) >= 100) {
    player_win_one.classList.remove('player-win_one');
    endGame();
  } else if (parseInt(globalScore2.textContent) >= 100) {
    player_win_two.classList.remove('player-win_two');
    endGame();
  }
}

holdButton.addEventListener('click', hold_points);

function hold_points() { 
  if (currentPlayer === 1) {
    let newScore = parseInt(playerOneScore.textContent) + parseInt(globalScore1.textContent);
    globalScore1.textContent = newScore;
    currentPlayer = 2;
    playerOneScore.textContent = 0;
  } else {
    let newScore = parseInt(playerTwoScore.textContent) + parseInt(globalScore2.textContent);
    globalScore2.textContent = newScore;
    currentPlayer = 1;
    playerTwoScore.textContent = 0;
  }
  showNotification(`C'est le tour du joueur ${currentPlayer}`);
  audio_notification.play();
};

function showNotification(message) {
  notificationElement.textContent = message;
  notificationElement.classList.add('notification-message');
  notificationElement.style.display = 'flex';

  setTimeout(() => {
    notificationElement.style.display = 'none';
    notificationElement.classList.remove('notification-message');
  }, 2500);
}

const resetButton = document.querySelector('.reset');
resetButton.addEventListener('click', function() {
  count = 0;
  playerOneScore.textContent = count;
  playerTwoScore.textContent = count;
  globalScore1.textContent = count;
  globalScore2.textContent = count;
  rollDiceButton.addEventListener("click", click_dice);
  rollDiceButton.classList.add('roll_dice');
  player_win_one.classList.add('player-win_one');
  player_win_two.classList.add('player-win_two');
  holdButton.addEventListener('click', hold_points);
  holdButton.classList.add('hold_points');
});

function endGame() {
  rollDiceButton.removeEventListener('click', click_dice);
  rollDiceButton.classList.remove('roll_dice');
  holdButton.removeEventListener('click', hold_points);
  holdButton.classList.remove('hold_points');
};


</script>



</body>
</html>
<!--Création d’un petit jeu sur navigateur web à l’aide du DOM.
Règles :
Le jeu comprend 2 joueurs sur un seul et même écran.
Chaque joueur possède un score temporaire (ROUND) et un score global (GLOBAL).
À chaque tour, le joueur a son ROUND initialisé à 0 et peut lancer un dé autant de fois qu'il le souhaite. Le
résultat d’un lancer est ajouté au ROUND.
Lors de son tour, le joueur peut décider à tout moment de:
- Cliquer sur l’option “Hold”, qui permet d’envoyer les points du ROUND vers le GLOBAL. Ce sera alors le
tour de l’autre joueur.
- Lancer le dé. S’il obtient un 1, son score ROUND est perdu et c’est la fin de son tour.
Le premier joueur qui atteint les 100 points sur global gagne le jeu.-->